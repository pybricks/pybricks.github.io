# pybricks blocks file:{"blocks":{"languageVersion":0,"blocks":[{"type":"blockGlobalSetup","id":"bjK,wS1MYO7aiYkFSwd{","x":-342,"y":60,"deletable":false,"next":{"block":{"type":"variables_set_essential_hub","id":"Q46-_j@I-rlt`^v6:,1^","extraState":{"optionLevel":0},"fields":{"VAR":{"id":"az`,0d)vZ#19vr}|bF`9"}},"next":{"block":{"type":"variables_set_motor","id":"x3.+@oz}Xgv~tA=/z5ov","fields":{"VAR":{"id":"![[[NLyH_2[.NvpiISoB"}},"inputs":{"PORT":{"shadow":{"type":"blockParametersPort","id":"=MLzg=q.SCy[+QbV2P_N","fields":{"NAME":"A"}}},"POSITIVE_DIRECTION":{"shadow":{"type":"blockParametersDirection","id":"4k_/`s,)s.-bx[?~bFn[","fields":{"SELECTION":"Direction.CLOCKWISE"}}}},"next":{"block":{"type":"variables_set_color_light_matrix","id":"j|jEfP1C~-^9NNiqCQJQ","fields":{"VAR":{"id":"f5#J(`}l~(!bOqrs5WKf"}},"inputs":{"PORT":{"shadow":{"type":"blockParametersPort","id":"m3w^IBsj.cn2`~6qgtCq","fields":{"NAME":"B"}}}},"next":{"block":{"type":"variables_set_stopwatch","id":"VwtVBkd-37?|N?^g[f?%","fields":{"VAR":{"id":"=%(bav]WBxi5o,;0=9D|"}},"next":{"block":{"type":"variables_setup_any","id":"sd6m3%UXQHrKUfSIBY!k","fields":{"VAR":{"id":"#qhABd_GG5Gz$@C*cw2X"}},"inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"j$wrc$do|s0NV27hI*yH","fields":{"NUM":0}},"block":{"type":"blockListGet","id":".axtA]-mw2h)h{]47[n8","extraState":{"optionLevel":4},"fields":{"METHOD":"LIST_GET_RANDOM"},"inputs":{"LIST":{"shadow":{"type":"blockListEmpty","id":"]ciF7=Y}a!%~OYgqu`C@"},"block":{"type":"blockListCreate","id":"8(0T8dD{VVj]guM?_qr9","extraState":{"optionLevel":2},"inputs":{"ADD0":{"shadow":{"type":"blockMathNumber","id":"rjc}W[nTnwvs~@tsQ8[A","fields":{"NUM":0}},"block":{"type":"variables_get_color","id":"z{X2q$1w?7q}~v#==+Cm","fields":{"COLOUR":"#0000ff","VAR":{"id":"EWz^^l3.[aeA,HT79hZf"}}}},"ADD1":{"shadow":{"type":"blockMathNumber","id":"44--%e)T_1LUaq!YO:1H","fields":{"NUM":0}},"block":{"type":"variables_get_color","id":"VI#O}~;F?B?RYbQs)h^(","fields":{"COLOUR":"#00ff00","VAR":{"id":":ik{@hWAG/[aPDCqjL.l"}}}}}}}}}}},"next":{"block":{"type":"variables_setup_any","id":"WhS/a-KDY9I?R)yqZ45I","fields":{"VAR":{"id":"0C)XDfi$7mcRSq[2oDu/"}},"inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"j$wrc$do|s0NV27hI*yH","fields":{"NUM":0}},"block":{"type":"blockMathArithmetic","id":"9)hK60tt`[~;0=(v`4ba","fields":{"OP":"MULTIPLY"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"V+!Ev$-BpO1,AqN[NMly","fields":{"NUM":1}},"block":{"type":"blockListCreate","id":"SOQ*WvLwV3wFmhS{mGvx","extraState":{"optionLevel":1},"inputs":{"ADD0":{"shadow":{"type":"blockMathNumber","id":"rjc}W[nTnwvs~@tsQ8[A","fields":{"NUM":0}},"block":{"type":"variables_get_color","id":"_P{30mC?kJS`Zcvup#9_","fields":{"COLOUR":"#000000","VAR":{"id":"@Yu4GIQai]=C7+4iG5*W"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"8dtU`D^E1pfOxmgB_iq_","fields":{"NUM":9}}}}}}},"next":{"block":{"type":"variables_setup_any","id":"BQBK9weR7N2d.[9(vHTa","fields":{"VAR":{"id":"9V2]u*M%BevJnMsZg+Uh"}},"inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"l}9xG-$F.i~wX~N8axkZ","fields":{"NUM":0}},"block":{"type":"blockMathArithmetic","id":"]=`6mQc*Up;(T={Vn-;w","fields":{"OP":"MULTIPLY"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"V+!Ev$-BpO1,AqN[NMly","fields":{"NUM":1}},"block":{"type":"blockListCreate","id":"~$G!1NR2SngQdd^=sNG^","extraState":{"optionLevel":1},"inputs":{"ADD0":{"shadow":{"type":"blockMathNumber","id":"rjc}W[nTnwvs~@tsQ8[A","fields":{"NUM":0}},"block":{"type":"variables_get_color","id":"XM}ZWl1QYA/sQPS+eAOp","fields":{"COLOUR":"#000000","VAR":{"id":"@Yu4GIQai]=C7+4iG5*W"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"[w4#x6fBdbH|l6_J]3p2","fields":{"NUM":9}}}}}}},"next":{"block":{"type":"variables_setup_any","id":"G3;(@#R!G2__Mor::i{V","fields":{"VAR":{"id":"k[~x_ylf}6S7#T)b|o[W"}},"inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"j$wrc$do|s0NV27hI*yH","fields":{"NUM":8}}}}}}}}}}}}}}}}}}}}},{"type":"blockGlobalStart","id":"3tJe|AWl0baN(wH9a$@.","x":-340,"y":620,"deletable":false,"next":{"block":{"type":"blockComment","id":"]--nBwM,tuHKc#6)exQz","fields":{"FIELDNAME":"The tic tac toe game can be described at any time by:\n- the state of the board (which spots are full, with either blue or green)\n- whose turn it currently is (green or blue)\n\nTo make things simple, we represent the game state with a list of 9 colors.\nThat way, we can directly show the current state on the color light matrix.\nThe color \"none\" is used to indicate a free spot.\n\nIn the setup, we randomly assign the first turn to either the green or blue\nplayer. For each completed turn, we add the current player's color to their\nselected position on the board (the selected position in the list)."},"next":{"block":{"type":"blockComment","id":"1/DThg7.7[/^Z^Fe8rF$","fields":{"FIELDNAME":"Allow the button to be used as an input, instead of stopping the program."},"next":{"block":{"type":"blockHubStopButton","id":"jpEGb6y0$cUfA~muj,cy","inputs":{"VAR":{"shadow":{"type":"variables_get_button_hub","id":"(a1qlRa*|F`n;guE%PRW","fields":{"VAR":{"id":"az`,0d)vZ#19vr}|bF`9","name":"hub","type":"EssentialHub"}}}},"VALUE0":{"shadow":{"type":"blockParametersButton","id":"9VHfh%?[lnTYnJy2$|.t","fields":{"VALUE":"CENTER"}},"block":{"type":"blockNone","id":"$[Hc|A1o3mm+g:b8g|WX"}}},"next":{"block":{"type":"blockLightOnColor","id":"3fiZeH52um_0PF89%lbo","extraState":{"optionLevel":1},"fields":{"METHOD":"LIGHT_ON"},"inputs":{"VAR":{"shadow":{"type":"variables_get_color_light_device","id":"sg0SxC9E@gmc}vY.]9)K","fields":{"VAR":{"id":"az`,0d)vZ#19vr}|bF`9","name":"hub","type":"EssentialHub"}}}},"COLOR":{"shadow":{"type":"variables_get_color","id":"=x:]%,eYd:v#393r20N,","fields":{"COLOUR":"#000000","VAR":{"id":"@Yu4GIQai]=C7+4iG5*W","name":"none","type":"ColorDef"}}}}},"next":{"block":{"type":"blockComment","id":"+WB/:aC*AU|:5uJU|z:H","fields":{"FIELDNAME":"Let the motor randomly indicate the first player."},"next":{"block":{"type":"blockIfElse","id":"Y.581fQIxv=5g[vpj?_k","extraState":{"optionLevel":1},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"5NBm+P%qQWB/{ioO`KM%"},"block":{"type":"blockLogicCompare","id":"MPEba6}J?.)$dLRZ(YSU","fields":{"OP1":"EQ"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"l|%7urg.MM#lA3t_V6=t","fields":{"NUM":3}},"block":{"type":"blockVariableGetValue","id":"dr?.U.po1Y=+oCeOU+Sx","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"|Myq17%;kN|k+_:m1;pC","fields":{"VAR":{"id":"#qhABd_GG5Gz$@C*cw2X","name":"turn","type":"Any"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"%=m,,G|cMsQ[vOoS(,b9","fields":{"NUM":4}},"block":{"type":"variables_get_color","id":"_e[s]c}3Jc2B]=RX1Fq$","fields":{"COLOUR":"#00ff00","VAR":{"id":":ik{@hWAG/[aPDCqjL.l"}}}}}}},"DO0":{"block":{"type":"blockMotorRun","id":"O5,Af;1KF~.v9mLGRJ}h","extraState":{"optionLevel":2},"fields":{"METHOD":"MOTOR_RUN_TO"},"inputs":{"VAR":{"shadow":{"type":"variables_get_motor_device","id":"%svh832hb[r/}w:pv4t,","fields":{"VAR":{"id":"![[[NLyH_2[.NvpiISoB","name":"player","type":"Motor"}}}},"VALUE0":{"shadow":{"type":"unit_angularVelocity","id":"WFiwQvT7~)%r?Co9SsZy","fields":{"VALUE0":500}}},"ANGLE":{"shadow":{"type":"unit_angle","id":"L|GzuoFXPEE^5MvWdQ`7","fields":{"VALUE0":765}}},"THEN":{"shadow":{"type":"parameters_stop_4","id":"(pSSLy~`k@jcd!6,`0@y","fields":{"VALUE":"Stop.COAST"}}}}}},"ELSE":{"block":{"type":"blockMotorRun","id":"`;lIkj/4z@z{`OQftj58","extraState":{"optionLevel":2},"fields":{"METHOD":"MOTOR_RUN_TO"},"inputs":{"VAR":{"shadow":{"type":"variables_get_motor_device","id":"$c.yI-i/2Y@9wuJ-fv)t","fields":{"VAR":{"id":"![[[NLyH_2[.NvpiISoB","name":"player","type":"Motor"}}}},"VALUE0":{"shadow":{"type":"unit_angularVelocity","id":"YNZ3vgjU3+T`mCN]bz5S","fields":{"VALUE0":500}}},"ANGLE":{"shadow":{"type":"unit_angle","id":"fH$WAc~~z.+y=F]:fL0C","fields":{"VALUE0":675}}},"THEN":{"shadow":{"type":"parameters_stop_4","id":"CAp3m+32-}Tu._-d|Yrc","fields":{"VALUE":"Stop.COAST"}}}}}}},"next":{"block":{"type":"blockComment","id":"5.*L@~c/+X2jsmf4+jDC","fields":{"FIELDNAME":"Discard the two full turns and reset the rotation sensor back to the\nmarker on the shaft. This way, positive angles indicate the green\nplayer and negative angles indicate the blue player."},"next":{"block":{"type":"blockMotorResetAngle","id":"|~5F[biM5DH.pmJOm?c;","inputs":{"VAR":{"shadow":{"type":"variables_get_motor_device","id":"b/iKgST:zMY@{,.U88|b","fields":{"VAR":{"id":"![[[NLyH_2[.NvpiISoB","name":"player","type":"Motor"}}}},"VALUE0":{"shadow":{"type":"unit_angle","id":"9Z,IBpw2#[;1p#w4$[65","fields":{"VALUE0":0}},"block":{"type":"blockNone","id":".Y[DN];[8_N5N#p54r]@"}}},"next":{"block":{"type":"blockComment","id":")A/_m-`t#^f.N9k6);@[","fields":{"FIELDNAME":"This is the outer loop. It repeats full turns until the game completes."},"next":{"block":{"type":"blockFlowWhile","id":"d1Q{ZQ]W@k-?-b[bfWIj","fields":{"MODE":"WHILE"},"inputs":{"BOOL":{"shadow":{"type":"blockLogicTrue","id":"T-^B[@#UN$8k~74e6R,9"}},"DO":{"block":{"type":"blockLightOnColor","id":"FD+IxcGk|U$8sg-;}#b)","extraState":{"optionLevel":1},"fields":{"METHOD":"LIGHT_ON"},"inputs":{"VAR":{"shadow":{"type":"variables_get_color_light_device","id":"SfmbbW@=z~VT)`_l;Nmx","fields":{"VAR":{"id":"az`,0d)vZ#19vr}|bF`9","name":"hub","type":"EssentialHub"}}}},"COLOR":{"shadow":{"type":"variables_get_color","id":"oIX|sS1LP6Ryc_wCV/[f","fields":{"COLOUR":"#ff0000","VAR":{"id":"aTzv!_#C~rfTI(wu?8iR","name":"red","type":"ColorDef"}}},"block":{"type":"blockVariableGetValue","id":"J#F*3a7Tqmqkn[Y=1=rZ","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"%%DGzS`i_(CZFaKiOtUF","fields":{"VAR":{"id":"#qhABd_GG5Gz$@C*cw2X","name":"turn","type":"Any"}}}}}}}},"next":{"block":{"type":"blockComment","id":"y%M$^]|6uT(C}eh8d_xG","fields":{"FIELDNAME":"This loop executes one turn of the current player, so it runs until\nthe current turn is complete. We check that in a separate function."},"next":{"block":{"type":"blockFlowWhile","id":"uZR%gMsR[f;4tyXv2xYm","fields":{"MODE":"UNTIL"},"inputs":{"BOOL":{"shadow":{"type":"blockLogicTrue","id":".@5`9L(010=hT2,.-d%P"},"block":{"type":"blockFunctionCallerValue","id":"4LeLhp]OH6jP/Oy~)}wQ","extraState":{"optionLevel":0},"fields":{"ICON":"TASK","VAR":{"id":"sLaAN?.R%%IfP[wNu-`?"}}}},"DO":{"block":{"type":"blockComment","id":"FWSWKgwKy)oa5B#NRK)5","fields":{"FIELDNAME":"The turn starts by ensuring the previous press is now released,\nso we don't immediately register another button press."},"next":{"block":{"type":"blockWaitUntil","id":"Gm3(ZZQ5b!JC|-K%o:C)","inputs":{"BOOL":{"shadow":{"type":"blockLogicTrue","id":"$$F)4+w@t$+(,eQT9KCM"},"block":{"type":"blockLogicIsNone","id":"ik3OLW9gq|VJrh|*FA][","fields":{"OP":"NOT"},"inputs":{"BOOL":{"shadow":{"type":"blockLogicTrue","id":"1J?Ctd8l.[!k:H1*QV:F"},"block":{"type":"blockButtonIsPressed","id":"1jco1QyD:9H.AdLi)(4!","inputs":{"VAR":{"shadow":{"type":"variables_get_keypad","id":"Ftco(bdqPIobVGEp#Fgb","fields":{"VAR":{"id":"az`,0d)vZ#19vr}|bF`9","name":"hub","type":"EssentialHub"}}}},"VALUE0":{"shadow":{"type":"blockParametersButton","id":".`a_1sbb%@cxd*73%T]K","fields":{"VALUE":"CENTER"}}}}}}}}}},"next":{"block":{"type":"blockComment","id":"gU?i{aq+(Tp5DY9b}0/g","fields":{"FIELDNAME":"Find the next free spot, up one from the last location."},"next":{"block":{"type":"blockVariableSetValue","id":"n0o|1#e.wb3)UN5yoGvV","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"ioT}=T1X-?G,9E-:bKI=","fields":{"VAR":{"id":"k[~x_ylf}6S7#T)b|o[W","name":"location","type":"Any"}}}},"VALUE0":{"shadow":{"type":"blockMathNumber","id":"^,nE9wE?jDV1,[a!EKf5","fields":{"NUM":0}},"block":{"type":"blockFunctionCallerValue","id":";^z4lSd6z=Q1g.FsWWhx","extraState":{"optionLevel":1},"fields":{"ICON":"TASK","VAR":{"id":"]t`596M^YL~XEaP#]scT"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":":zF/N`f(Z|]*VVsL:-jU","fields":{"NUM":0}},"block":{"type":"blockMathArithmetic","id":"fxpH3Xmeh/f:_I)r?@*u","fields":{"OP":"ADD"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"EF5p9}ZmQTnXcgTt$4@v","fields":{"NUM":1}},"block":{"type":"blockVariableGetValue","id":"de`Od9(yQy(),wOymvAQ","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"X0=%+M*~o8@u!|_!NLHV","fields":{"VAR":{"id":"k[~x_ylf}6S7#T)b|o[W","name":"location","type":"Any"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"4|tMLKt$tPdC8ilp_a3/","fields":{"NUM":1}}}}}}}}}},"next":{"block":{"type":"blockComment","id":":(=5wzt-$#|!5Y.I,U!@","fields":{"FIELDNAME":"Blink until turn or complete or button pressed. Instead of waiting\nsome time between turning the light on and off, we keep waiting\nfor several things at once. The blink is completes if it is time to\nblink again or the turn is complete or the button is pressed to\nchange the selected position."},"next":{"block":{"type":"blockFlowWhile","id":"-2FXzamaZJ{AY+0/y85F","fields":{"MODE":"UNTIL"},"inputs":{"BOOL":{"shadow":{"type":"blockLogicTrue","id":"(`!ro:gq/c,Y#!4K9NuM"},"block":{"type":"blockLogicOperation","id":"n}%y_}q]F(]f/%h?RaIG","fields":{"OP":"OR"},"inputs":{"A":{"shadow":{"type":"blockLogicTrue","id":"7JldLy$cM|T;Xph7;^NL"},"block":{"type":"blockFunctionCallerValue","id":"^]C6;}7;c_(54SdH;#U0","extraState":{"optionLevel":0},"fields":{"ICON":"TASK","VAR":{"id":"sLaAN?.R%%IfP[wNu-`?"}}}},"B":{"shadow":{"type":"blockLogicTrue","id":"p602./k0}z/(^2-!NtjP"},"block":{"type":"blockButtonIsPressed","id":".==|2~6EiVvt9v%LOoC/","inputs":{"VAR":{"shadow":{"type":"variables_get_keypad","id":"bxe*nnC;=ax#bK+e[1T)","fields":{"VAR":{"id":"az`,0d)vZ#19vr}|bF`9","name":"hub","type":"EssentialHub"}}}},"VALUE0":{"shadow":{"type":"blockParametersButton","id":"}+Fw0]p4w#wR#AQ!V|ut","fields":{"VALUE":"CENTER"}}}}}}}}},"DO":{"block":{"type":"blockComment","id":"0IY@k2)OW!7P+9ITj`wB","fields":{"FIELDNAME":"Show game state for the current selection being off and then on.\nThis creates a blink."},"next":{"block":{"type":"blockFlowForEach","id":"23TWA4k{hh*3$]4UV/r=","inputs":{"VAR":{"shadow":{"type":"variables_setup_iterable","id":"b[~6_/.BFPf$VQN{*cI2","fields":{"VAR":{"id":"}4E6!r8(8EC~Md[[0y9T","name":"blink color","type":"LoopVariable"}}}},"LIST":{"shadow":{"type":"blockListEmpty","id":"$02V`F|sBGa,l;%-JJlm"},"block":{"type":"blockListCreate","id":"kTG#R{GbtN9U,)x*1]Gh","extraState":{"optionLevel":2},"inputs":{"ADD0":{"shadow":{"type":"blockMathNumber","id":"r-IJ.}y1h|a^~s~zss_)","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"tE^dKLykQH*.fj={/.Js","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"A6o%h7g2mYY+WD]BauLQ","fields":{"VAR":{"id":"#qhABd_GG5Gz$@C*cw2X","name":"turn","type":"Any"}}}}}}},"ADD1":{"shadow":{"type":"blockMathNumber","id":".+A;?MzD;7}fv:r.=~^q","fields":{"NUM":0}},"block":{"type":"variables_get_color","id":"m(I#]7iJlW%e%-3waB@#","fields":{"COLOUR":"#000000","VAR":{"id":"@Yu4GIQai]=C7+4iG5*W"}}}}}}},"DO":{"block":{"type":"blockListSet","id":"AMW~ma2=03dcq)Z*,oD-","extraState":{"optionLevel":1},"fields":{"METHOD":"LIST_SET_INDEX"},"inputs":{"LIST":{"shadow":{"type":"blockListEmpty","id":".VnXMvk|VJ=|kpDAGUD)"},"block":{"type":"blockVariableGetValue","id":"e2/zUak5utYuUuyKIWq~","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"/!CZZ,a)B;B5_U2L4?};","fields":{"VAR":{"id":"0C)XDfi$7mcRSq[2oDu/","name":"game","type":"Any"}}}}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"]MRw#Tl?=#b1d+vbn|kO","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"R1REQ/8;n[]UIZ@NB9Z/","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"*k0o$Q$AnCWM:Q5Lpe*,","fields":{"VAR":{"id":"k[~x_ylf}6S7#T)b|o[W","name":"location","type":"Any"}}}}}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"HG`Da_e.U:]TQz*r[g3P","fields":{"NUM":123}},"block":{"type":"variables_setup_iterableConstant","id":"OJE.|A.0$R?#E{!6Tc^[","fields":{"VAR":{"text":"blink color"}}}}},"next":{"block":{"type":"blockLightOnColor","id":"U!v$v`Y*S4n7n)KEp.^M","extraState":{"optionLevel":1},"fields":{"METHOD":"LIGHT_ON"},"inputs":{"VAR":{"shadow":{"type":"variables_get_color_light_device","id":"$RgIk)[)b{~?YB_wMmS4","fields":{"VAR":{"id":"f5#J(`}l~(!bOqrs5WKf","name":"matrix","type":"ColorLightMatrix"}}}},"COLOR":{"shadow":{"type":"variables_get_color","id":"0;-yl0o8gj/^C/kF{Zgx","fields":{"COLOUR":"#ff0000","VAR":{"id":"aTzv!_#C~rfTI(wu?8iR","name":"red","type":"ColorDef"}}},"block":{"type":"blockVariableGetValue","id":"b;ivl.IElK5KM{hcOV|Y","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"sGy#(=lp{_~af]PlC_D(","fields":{"VAR":{"id":"0C)XDfi$7mcRSq[2oDu/","name":"game","type":"Any"}}}}}}}},"next":{"block":{"type":"blockStopWatchDo","id":"E8Q(|hQBsie8a2l9_!]B","extraState":{"optionLevel":0},"fields":{"METHOD":"STOPWATCH_RESET"},"inputs":{"VAR":{"shadow":{"type":"variables_get_stopwatch","id":"XB:Y%IqMsX9Oj/Lz[0)%","fields":{"VAR":{"id":"=%(bav]WBxi5o,;0=9D|","name":"blink time","type":"StopWatch"}}}}},"next":{"block":{"type":"blockWaitUntil","id":"k]{e)MDM3I;V/nD!O`.l","inputs":{"BOOL":{"shadow":{"type":"blockLogicTrue","id":"av)K~BqZZ$)=K)*dli3#"},"block":{"type":"blockLogicOperation","id":"9?6Rn9t):jV;)uu~%r?1","fields":{"OP":"OR"},"inputs":{"A":{"shadow":{"type":"blockLogicTrue","id":"fW,BB7f8SN$+%%FNMVSa"},"block":{"type":"blockLogicCompare","id":"eBR${]4,-Lm;h_D#wliw","fields":{"OP1":"GT"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"[yfp4g2M(]d]CvJYXBIM","fields":{"NUM":3}},"block":{"type":"blockStopWatchTime","id":"$OEQ`c,iy/Xi^~GA7)3u","inputs":{"VAR":{"shadow":{"type":"variables_get_stopwatch","id":"ho%0ZEo$-M`,+?`%y]*I","fields":{"VAR":{"id":"=%(bav]WBxi5o,;0=9D|","name":"blink time","type":"StopWatch"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"f;rq5WqTpzF_}gA:2LGk","fields":{"NUM":200}}}}}},"B":{"shadow":{"type":"blockLogicTrue","id":",hVeN*0kut.a%/J19kAW"},"block":{"type":"blockLogicOperation","id":"aXM|U-l5Cm)bX_Tl~!G@","fields":{"OP":"OR"},"inputs":{"A":{"shadow":{"type":"blockLogicTrue","id":"7JldLy$cM|T;Xph7;^NL"},"block":{"type":"blockFunctionCallerValue","id":"OE7wI(jLe?A[=E+dKk%S","extraState":{"optionLevel":0},"fields":{"ICON":"TASK","VAR":{"id":"sLaAN?.R%%IfP[wNu-`?"}}}},"B":{"shadow":{"type":"blockLogicTrue","id":"p602./k0}z/(^2-!NtjP"},"block":{"type":"blockButtonIsPressed","id":"~f}S:td,Yh{VrFW0_bXa","inputs":{"VAR":{"shadow":{"type":"variables_get_keypad","id":"qZF9jODL4lv`uiw]+69M","fields":{"VAR":{"id":"az`,0d)vZ#19vr}|bF`9","name":"hub","type":"EssentialHub"}}}},"VALUE0":{"shadow":{"type":"blockParametersButton","id":"fSGS2Pz~Lz)%qk/6aLuT","fields":{"VALUE":"CENTER"}}}}}}}}}}}}}}}}}}}}}}}}}}},"next":{"block":{"type":"blockComment","id":"zEjEZ`5}([hj1N4#$r!}","fields":{"FIELDNAME":"The blink might just have been on or off at this point, so reinstate\ngame state based on whether turn complete or not."},"next":{"block":{"type":"blockListSet","id":"kbWYWg5]Sb2-Iswd[WKR","extraState":{"optionLevel":1},"fields":{"METHOD":"LIST_SET_INDEX"},"inputs":{"LIST":{"shadow":{"type":"blockListEmpty","id":".VnXMvk|VJ=|kpDAGUD)"},"block":{"type":"blockVariableGetValue","id":"%vNakq00uz}HIg!O2le1","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"9RLw#6X|}z_QX)XUvXma","fields":{"VAR":{"id":"0C)XDfi$7mcRSq[2oDu/","name":"game","type":"Any"}}}}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"]MRw#Tl?=#b1d+vbn|kO","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"6_lZlyeg/PT]yU/v8vfb","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"5qiz:69gmGS+3|jLiUHb","fields":{"VAR":{"id":"k[~x_ylf}6S7#T)b|o[W","name":"location","type":"Any"}}}}}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"HG`Da_e.U:]TQz*r[g3P","fields":{"NUM":123}},"block":{"type":"blockLogicTernary","id":"gmcJ0+h9(zQFy{Z!d#f+","inputs":{"THEN":{"shadow":{"type":"blockMathNumber","id":"Wl,emtgZy[PpyX/Cy.*8","fields":{"NUM":1}},"block":{"type":"blockVariableGetValue","id":"o%bQ=[a5Uz?1O`=Ajah3","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"wnit[oWMDy{JtE48;$Qp","fields":{"VAR":{"id":"#qhABd_GG5Gz$@C*cw2X","name":"turn","type":"Any"}}}}}}},"IF":{"shadow":{"type":"blockLogicTrue","id":"],5?vuJXb|r$Wjps8|bq"},"block":{"type":"blockFunctionCallerValue","id":"B)N;_-J!2n4Nx/~~;ND8","extraState":{"optionLevel":0},"fields":{"ICON":"TASK","VAR":{"id":"sLaAN?.R%%IfP[wNu-`?"}}}},"ELSE":{"shadow":{"type":"blockMathNumber","id":"fYVkxG7O4l_8`h$/;K-W","fields":{"NUM":0}},"block":{"type":"variables_get_color","id":"I+djVapa6RrAJFv:`JJs","fields":{"COLOUR":"#000000","VAR":{"id":"@Yu4GIQai]=C7+4iG5*W"}}}}}}}}}}}}}}}}}}}}}}}}},"next":{"block":{"type":"blockComment","id":"=b/t,:jmY1K9PH?BIp8P","fields":{"FIELDNAME":"With the user turn complete, we can check if anyone has one yet,\nusing a separate function. That will then exit the program."},"next":{"block":{"type":"blockFunctionCallerStatement","id":"7~wpk+Z2Iie@35A.mKaG","extraState":{"optionLevel":0},"fields":{"ICON":"TASK","VAR":{"id":"JewIrE7WluNH!g@zFH:["}},"next":{"block":{"type":"blockComment","id":"9PGYcz1HyKJGXI2/p18Z","fields":{"FIELDNAME":"But otherwise it is the next player's turn. So change to blue if it was\ngreen, or change to green if it was blue."},"next":{"block":{"type":"blockVariableSetValue","id":"f9ys(lNrBN}W(81XaXS]","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"NeOb+_@a9FW@5oTsoedY","fields":{"VAR":{"id":"#qhABd_GG5Gz$@C*cw2X","name":"turn","type":"Any"}}}},"VALUE0":{"shadow":{"type":"blockMathNumber","id":"IhhbTw-MH1X][VtzQ9q|","fields":{"NUM":0}},"block":{"type":"blockLogicTernary","id":"/^sv4vQVQ1F?!Gqt9U$|","inputs":{"THEN":{"shadow":{"type":"blockMathNumber","id":"+m7V785Fn1-R/5z)40KN","fields":{"NUM":1}},"block":{"type":"variables_get_color","id":"9P3j.=byOIb}|8GcOTIr","fields":{"COLOUR":"#0000ff","VAR":{"id":"EWz^^l3.[aeA,HT79hZf"}}}},"IF":{"shadow":{"type":"blockLogicTrue","id":"%Ui!~(94(n*lXglwIh9l"},"block":{"type":"blockLogicCompare","id":"0*fDl%tggYM3:j:y_dIl","fields":{"OP1":"EQ"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"3uIBYYp4n7lVEd`6jt*M","fields":{"NUM":3}},"block":{"type":"blockVariableGetValue","id":"Z`1LK5Uxp{p|[DhRT2%Y","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"~gA3}sVN@ZS{ewxvTWCx","fields":{"VAR":{"id":"#qhABd_GG5Gz$@C*cw2X","name":"turn","type":"Any"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"IB5{y+zSR?JfY[_H}nCf","fields":{"NUM":4}},"block":{"type":"variables_get_color","id":"27*NG}jR+}a]VLD.5:Ib","fields":{"COLOUR":"#00ff00","VAR":{"id":":ik{@hWAG/[aPDCqjL.l"}}}}}}},"ELSE":{"shadow":{"type":"blockMathNumber","id":"[g2BTCcS2a#]=g^oK`1=","fields":{"NUM":0}},"block":{"type":"variables_get_color","id":"qZ2,LALDAVz2RV9L~g2s","fields":{"COLOUR":"#00ff00","VAR":{"id":":ik{@hWAG/[aPDCqjL.l"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},{"type":"variables_setup_function","id":"O|qtxM[Az[2RVyXM`7Wd","x":658,"y":824,"extraState":{"optionLevel":1},"fields":{"ICON":"TASK","VAR":{"id":"]t`596M^YL~XEaP#]scT"}},"inputs":{"ARG0":{"shadow":{"type":"variables_setup_function_argument","id":"NPaW1/)k76D5cuBQbU[I","fields":{"VAR":{"id":"Xh2]1$w;@#-wD:h7sh{E","name":"current","type":"FunctionArgument"}}}},"STACK":{"block":{"type":"blockComment","id":"|~wZ0Zb)T;`k.bzmAt;0","fields":{"FIELDNAME":"To find the next free spot, go over all 9 spots, and\nreturn the first one that is free, so no color. We\nstart checking from the given position"},"next":{"block":{"type":"blockFlowForEach","id":"Rl[-:|U5_]X-cSW2OKrr","inputs":{"VAR":{"shadow":{"type":"variables_setup_iterable","id":"CS.MafrMH/Q!Feg90hF(","fields":{"VAR":{"id":"emJj5[6$8~B412X_y;8f","name":"index","type":"LoopVariable"}}}},"LIST":{"shadow":{"type":"blockListEmpty","id":":cyFwX|FqvVScQz8LE.!"},"block":{"type":"blockRange","id":"_a4ltJGZ}?28q|gX0q@j","extraState":{"optionLevel":1},"inputs":{"RANGE_FROM":{"shadow":{"type":"blockMathNumber","id":"(VLDwn=diHwt1z.82rF:","fields":{"NUM":0}},"block":{"type":"variables_setup_function_argumentConstant","id":"77fR7dscTBo4V~pKXJ;q","fields":{"VAR":{"text":"current"}}}},"RANGE_TO":{"shadow":{"type":"blockMathNumber","id":"SJLJZ=#,_g2MEP6ImKyY","fields":{"NUM":9}},"block":{"type":"blockMathArithmetic","id":"^g%,;J!,0#8J5:O]C(+n","fields":{"OP":"ADD"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"$_itQrDtXCemmn)67oTQ","fields":{"NUM":1}},"block":{"type":"variables_setup_function_argumentConstant","id":"aqz|g/`#`o3k_F*Y}S.t","fields":{"VAR":{"text":"current"}}}},"B":{"shadow":{"type":"blockMathNumber","id":"Kd4cy-FDHrkH?)u](Mr?","fields":{"NUM":9}}}}}},"RANGE_STEPS":{"shadow":{"type":"blockMathNumber","id":"/^~[A/j^||d/QEbKLB~[","fields":{"NUM":1}}}}}},"DO":{"block":{"type":"blockIfElse","id":"MQ%iC`5a)aqh}b)??BDQ","extraState":{"optionLevel":0},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"?`IK/o@K(i-TmJlk`.4B"},"block":{"type":"blockLogicCompare","id":"=Y31IQB~Mb`prB_pX7s)","fields":{"OP1":"EQ"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"g!+azsK/H/f{tP2sYrvY","fields":{"NUM":3}},"block":{"type":"blockFunctionCallerValue","id":"yq]pN)4co@UjP_S27mcf","extraState":{"optionLevel":1},"fields":{"ICON":"TASK","VAR":{"id":",ix$7lYFLANh,-P4K|W3"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"_nHql-t7yepFM2(0s7TL","fields":{"NUM":0}},"block":{"type":"blockMathOp","id":"s[;o{X9Mk7o+59Scs}?#","extraState":{"optionLevel":1},"fields":{"OP":"MODULO"},"inputs":{"NUM":{"shadow":{"type":"blockMathNumber","id":"6Weh-K8%/xMn^AxWJf(p","fields":{"NUM":0}},"block":{"type":"variables_setup_iterableConstant","id":"3X}Lbo03U:a~)c)x7?{;","fields":{"VAR":{"text":"index"}}}},"NUM2":{"shadow":{"type":"blockMathNumber","id":"*x5!^*o1Q!]5{gGHw0Y]","fields":{"NUM":9}}}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"mi;d!V|5+[n*hUC{#3J+","fields":{"NUM":4}},"block":{"type":"variables_get_color","id":"rUU#K2jx[VYj;@i,J8ob","fields":{"COLOUR":"#000000","VAR":{"id":"@Yu4GIQai]=C7+4iG5*W"}}}}}}},"DO0":{"block":{"type":"blockComment","id":"Uf%HH1bVwUtG4wRY0:Mp","fields":{"FIELDNAME":"If that spot still has no color, we can use it."},"next":{"block":{"type":"blockTaskReturn","id":"%^N26xV?!OBS.l0(bIIZ","inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"hgReSoEiIwIdmpcYX(Vb","fields":{"NUM":0}},"block":{"type":"blockMathOp","id":"dRWsz603HE_%ULh7-x=m","extraState":{"optionLevel":1},"fields":{"OP":"MODULO"},"inputs":{"NUM":{"shadow":{"type":"blockMathNumber","id":"6Weh-K8%/xMn^AxWJf(p","fields":{"NUM":0}},"block":{"type":"variables_setup_iterableConstant","id":"rL1DR+UEmP4?$a8;j~k_","fields":{"VAR":{"text":"index"}}}},"NUM2":{"shadow":{"type":"blockMathNumber","id":"|VwK5Tr]Pwlb{TP+kM7A","fields":{"NUM":9}}}}}}}}}}}}}}},"next":{"block":{"type":"blockComment","id":"pwka:S5YR?po6;G@z(gG","fields":{"FIELDNAME":"If we didn't find a free spot anywhere, all spots are full. And yet\nnobody has one yet. so it's a draw. Game over!\nBlink a white flag to indicate this."},"next":{"block":{"type":"blockLightOnColor","id":"H:(lM.gKqTrp`8OTw$W0","extraState":{"optionLevel":1},"fields":{"METHOD":"LIGHT_ON"},"inputs":{"VAR":{"shadow":{"type":"variables_get_color_light_device","id":"!zEc23I2t[lx@;!0`EEq","fields":{"VAR":{"id":"f5#J(`}l~(!bOqrs5WKf","name":"matrix","type":"ColorLightMatrix"}}}},"COLOR":{"shadow":{"type":"variables_get_color","id":"pQAgQPK,!kJNuY!Fy@x;","fields":{"COLOUR":"#ffffff","VAR":{"id":"aYIJoh-}4`.kH7:G/9T_","name":"white","type":"ColorDef"}}}}},"next":{"block":{"type":"blockWaitTime","id":"~I[jGJ(=X_s]U;.8M0R-","inputs":{"VALUE0":{"shadow":{"type":"unit_time","id":"bDjH!I@O6HfI?YkEIc2.","fields":{"VALUE0":1000}}}},"next":{"block":{"type":"blockLightOnColor","id":"YY?Q.)Bbsd8.22XTLpME","extraState":{"optionLevel":1},"fields":{"METHOD":"LIGHT_ON"},"inputs":{"VAR":{"shadow":{"type":"variables_get_color_light_device","id":"AGF*(?E#)Z^g,P^z3gOR","fields":{"VAR":{"id":"f5#J(`}l~(!bOqrs5WKf","name":"matrix","type":"ColorLightMatrix"}}}},"COLOR":{"shadow":{"type":"variables_get_color","id":"/L*?:rPqYJZKC!MoP/N[","fields":{"COLOUR":"#000000","VAR":{"id":"@Yu4GIQai]=C7+4iG5*W","name":"none","type":"ColorDef"}}}}},"next":{"block":{"type":"blockProgramStop","id":"$]ve0pbW;9agU4s9MG{+"}}}}}}}}}}}}}}}},{"type":"variables_setup_function","id":"P^3Y-4OA(ciHInK~u_gH","x":659,"y":1643,"extraState":{"optionLevel":0},"fields":{"ICON":"TASK","VAR":{"id":"sLaAN?.R%%IfP[wNu-`?"}},"inputs":{"STACK":{"block":{"type":"blockComment","id":"ZbPqQ6){x[`*8*M(?%|C","fields":{"FIELDNAME":"Blue's turn is complete if they push the motor to the positive side."},"next":{"block":{"type":"blockIfElse","id":"S(ZXs^+/lW@*$b{9j;QP","extraState":{"optionLevel":0},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"-q|q_*{WU+_:-N%rV=hM"},"block":{"type":"blockLogicOperation","id":"/M^6m#9`UD%Z%$`e*R0l","fields":{"OP":"AND"},"inputs":{"A":{"shadow":{"type":"blockLogicTrue","id":"_$p%w2,cYc2KA4*26pxo"},"block":{"type":"blockLogicCompare","id":"X(,Wa:=RcU];id,eR-([","fields":{"OP1":"EQ"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"3uIBYYp4n7lVEd`6jt*M","fields":{"NUM":3}},"block":{"type":"blockVariableGetValue","id":"FM^XGYD_d)v[A(]m#{WM","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"U^~}QGwdpL1)WR;$L*I$","fields":{"VAR":{"id":"#qhABd_GG5Gz$@C*cw2X","name":"turn","type":"Any"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"IB5{y+zSR?JfY[_H}nCf","fields":{"NUM":4}},"block":{"type":"variables_get_color","id":"{~EJ1t~k$p!OyEAaz3^`","fields":{"COLOUR":"#0000ff","VAR":{"id":"EWz^^l3.[aeA,HT79hZf"}}}}}}},"B":{"shadow":{"type":"blockLogicTrue","id":"Z40HIQzYbWQWj^5S)F-_"},"block":{"type":"blockLogicCompare","id":"/q`%0#YR8;-a,/71;{;b","fields":{"OP1":"GT"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"7lb*kvg1OPrH0/F7SE^R","fields":{"NUM":3}},"block":{"type":"blockMotorMeasure","id":"nN(NV[{?:v?voZqp+:y(","extraState":{"optionLevel":1},"fields":{"METHOD":"MOTOR_ANGLE"},"inputs":{"VAR":{"shadow":{"type":"variables_get_motor_device","id":"4lK98K{WP2)%qlO3QGq8","fields":{"VAR":{"id":"![[[NLyH_2[.NvpiISoB","name":"player","type":"Motor"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"i)BJ%Wix]?=4zI*BuZ4N","fields":{"NUM":30}}}}}}}}},"DO0":{"block":{"type":"blockTaskReturn","id":"OIJ2+45.s:P1s(kMBvfs","inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"M@*vKH30o0#Uo^:C}#2}","fields":{"NUM":0}},"block":{"type":"blockLogicTrueFalse","id":"Y7Z|Fiu|mLzxSwmDj:l[","fields":{"BOOL":"TRUE"}}}}}}},"next":{"block":{"type":"blockComment","id":"6F]9{YA[w-f`v*T-.|BM","fields":{"FIELDNAME":"Green's turn is complete if they push the motor to the negative side."},"next":{"block":{"type":"blockIfElse","id":".*k?Bh[yTS;P^a=7Dcp-","extraState":{"optionLevel":0},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"-q|q_*{WU+_:-N%rV=hM"},"block":{"type":"blockLogicOperation","id":"KZ9;qJVn+tmg_8[mR@YF","fields":{"OP":"AND"},"inputs":{"A":{"shadow":{"type":"blockLogicTrue","id":"_$p%w2,cYc2KA4*26pxo"},"block":{"type":"blockLogicCompare","id":"~XYuwqC=ucPKgbOk~KsU","fields":{"OP1":"EQ"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"3uIBYYp4n7lVEd`6jt*M","fields":{"NUM":3}},"block":{"type":"blockVariableGetValue","id":"rF-%2jE0T#R,Xk151=Oa","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"BS3W_p~-:9AzAo*RMJFj","fields":{"VAR":{"id":"#qhABd_GG5Gz$@C*cw2X","name":"turn","type":"Any"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"IB5{y+zSR?JfY[_H}nCf","fields":{"NUM":4}},"block":{"type":"variables_get_color","id":"c.S|oOU1PVMwZ8t|(`4z","fields":{"COLOUR":"#00ff00","VAR":{"id":":ik{@hWAG/[aPDCqjL.l"}}}}}}},"B":{"shadow":{"type":"blockLogicTrue","id":"Z40HIQzYbWQWj^5S)F-_"},"block":{"type":"blockLogicCompare","id":"|AVCaDo=(tD_^geMnBsq","fields":{"OP1":"LT"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"7lb*kvg1OPrH0/F7SE^R","fields":{"NUM":3}},"block":{"type":"blockMotorMeasure","id":"p`Ii*;f$!JASb)Vf#1w$","extraState":{"optionLevel":1},"fields":{"METHOD":"MOTOR_ANGLE"},"inputs":{"VAR":{"shadow":{"type":"variables_get_motor_device","id":"4h;gc=Exj?kSqy[RU}V]","fields":{"VAR":{"id":"![[[NLyH_2[.NvpiISoB","name":"player","type":"Motor"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"ri=Uv#P)07p%~_DpGEhR","fields":{"NUM":-30}}}}}}}}},"DO0":{"block":{"type":"blockTaskReturn","id":"o:*XmDhqG+3[@u3{$Sp%","inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"M@*vKH30o0#Uo^:C}#2}","fields":{"NUM":0}},"block":{"type":"blockLogicTrueFalse","id":"?qzBP^r.l-l-q$oa;6!1","fields":{"BOOL":"TRUE"}}}}}}},"next":{"block":{"type":"blockComment","id":":j~OZX?b-D!M`dr$xnCo","fields":{"FIELDNAME":"Otherwise the turn is not done, so return false."},"next":{"block":{"type":"blockTaskReturn","id":"9%/a+MkNGOv*e;orheNu","inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"M@*vKH30o0#Uo^:C}#2}","fields":{"NUM":0}},"block":{"type":"blockLogicTrueFalse","id":"J$?b+3W?$uyjO|~vo(Sl","fields":{"BOOL":"FALSE"}}}}}}}}}}}}}}}}}},{"type":"variables_setup_function","id":"MIS*W.CQcp/m~NvOpQe9","x":1696,"y":1582,"extraState":{"optionLevel":0},"fields":{"ICON":"TASK","VAR":{"id":"JewIrE7WluNH!g@zFH:["}},"inputs":{"STACK":{"block":{"type":"blockComment","id":"Q,F;`|:k.2k.f5o,0KEu","fields":{"FIELDNAME":"Check rows for a winner."},"next":{"block":{"type":"blockFunctionCallerStatement","id":"~/0kjj)Wa1y.eg2]!OL}","extraState":{"optionLevel":3},"fields":{"ICON":"TASK","VAR":{"id":"=aT_znU4^@0XF=_AC~QZ"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"6oY5fk(a-s:|MIt_IQkj","fields":{"NUM":0}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"|WPhiut:)v{Tf:3g??0A","fields":{"NUM":1}}},"ARG2":{"shadow":{"type":"blockMathNumber","id":"Iy5VRs:G{aW;t!Rjrn_F","fields":{"NUM":2}}}},"next":{"block":{"type":"blockFunctionCallerStatement","id":"Z2X?I^2(cZQrcM$#.hxX","extraState":{"optionLevel":3},"fields":{"ICON":"TASK","VAR":{"id":"=aT_znU4^@0XF=_AC~QZ"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"BCZxAmOY!Buwj/^_E#uX","fields":{"NUM":3}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"YHR,0Ih4JH8rQOw4prQ?","fields":{"NUM":4}}},"ARG2":{"shadow":{"type":"blockMathNumber","id":"D]ePy%E9!OXre9Yb%%]L","fields":{"NUM":5}}}},"next":{"block":{"type":"blockFunctionCallerStatement","id":"(*=DY{lNNN~,A8.-alES","extraState":{"optionLevel":3},"fields":{"ICON":"TASK","VAR":{"id":"=aT_znU4^@0XF=_AC~QZ"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"VDY_WcXKqhOJgq(]_8+#","fields":{"NUM":6}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"S~K)3k-TFt*K|Nyk5[:O","fields":{"NUM":7}}},"ARG2":{"shadow":{"type":"blockMathNumber","id":"D$RcdB^v*x]tsS]`qI?S","fields":{"NUM":8}}}},"next":{"block":{"type":"blockComment","id":"OGB](u(T0r]%O?A=+NJ$","fields":{"FIELDNAME":"Check columns for a winner."},"next":{"block":{"type":"blockFunctionCallerStatement","id":"JvZe0~k^MLcK~Ex#X0O(","extraState":{"optionLevel":3},"fields":{"ICON":"TASK","VAR":{"id":"=aT_znU4^@0XF=_AC~QZ"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"Ev^3rQwXlp.W4](e8Y?n","fields":{"NUM":0}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"EKL04[.Oy;W`K983G7Bl","fields":{"NUM":3}}},"ARG2":{"shadow":{"type":"blockMathNumber","id":"J*$$IsfS]lmu|7kUqwB:","fields":{"NUM":6}}}},"next":{"block":{"type":"blockFunctionCallerStatement","id":"wc)r[mgW7J?]#+xPjzM+","extraState":{"optionLevel":3},"fields":{"ICON":"TASK","VAR":{"id":"=aT_znU4^@0XF=_AC~QZ"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"N8xN|4Q~B.ZK?ENhQP*x","fields":{"NUM":1}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"jH:@72G-~n{DTkT.+nQM","fields":{"NUM":4}}},"ARG2":{"shadow":{"type":"blockMathNumber","id":"_lB;E7%nL(h:bs0@O3FC","fields":{"NUM":7}}}},"next":{"block":{"type":"blockFunctionCallerStatement","id":"|)F3#5.4,Z#q4Q8/[*[/","extraState":{"optionLevel":3},"fields":{"ICON":"TASK","VAR":{"id":"=aT_znU4^@0XF=_AC~QZ"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"_$}P!I-iAH3s6Dj7gL3K","fields":{"NUM":2}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"N}U=%[@,gg(9r7^vYm1a","fields":{"NUM":5}}},"ARG2":{"shadow":{"type":"blockMathNumber","id":"((^,?_s;9;=CpT;XA|?k","fields":{"NUM":8}}}},"next":{"block":{"type":"blockComment","id":"Bu]_SN#3TSJLI?:RI}$[","fields":{"FIELDNAME":"Check diagonals for a winner."},"next":{"block":{"type":"blockFunctionCallerStatement","id":"ed}abM|p5kC8WDCwe5XO","extraState":{"optionLevel":3},"fields":{"ICON":"TASK","VAR":{"id":"=aT_znU4^@0XF=_AC~QZ"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"68ts[_$X5hfsF=?yh8~J","fields":{"NUM":0}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":")nzvJfwj{piKKg}3t[dh","fields":{"NUM":4}}},"ARG2":{"shadow":{"type":"blockMathNumber","id":"X4C[5j`HN=V?_*mhalkN","fields":{"NUM":8}}}},"next":{"block":{"type":"blockFunctionCallerStatement","id":"!a8p3$J(Vl|D=7x5jx6#","extraState":{"optionLevel":3},"fields":{"ICON":"TASK","VAR":{"id":"=aT_znU4^@0XF=_AC~QZ"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"YG$6Z/,s~X^?TxJ}^lAL","fields":{"NUM":2}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"JZ;tA(fUfe5^+)6y_Bi3","fields":{"NUM":4}}},"ARG2":{"shadow":{"type":"blockMathNumber","id":"zLJq!N5r+1rY^UI/RtIn","fields":{"NUM":6}}}}}}}}}}}}}}}}}}}}}}}}}}}},{"type":"variables_setup_function","id":"N=z+hw.}ic1Lm#7?o$@G","x":1700,"y":59,"extraState":{"optionLevel":3},"fields":{"ICON":"TASK","VAR":{"id":"=aT_znU4^@0XF=_AC~QZ"}},"inputs":{"ARG0":{"shadow":{"type":"variables_setup_function_argument","id":"5-+t=Gv@yvvC~~#@HRc,","fields":{"VAR":{"id":"Pkr_3Z79v+e.S?R(EFj.","name":"a","type":"FunctionArgument"}}}},"ARG1":{"shadow":{"type":"variables_setup_function_argument","id":"4R^(@VPCV#HEQN((,OF}","fields":{"VAR":{"id":"4$32u,DT$rbR1Kv1M:kK","name":"b","type":"FunctionArgument"}}}},"ARG2":{"shadow":{"type":"variables_setup_function_argument","id":"rRgI(geL;7lQM+QmWa@S","fields":{"VAR":{"id":"1ou`44W7`q}U+b[S@2rk","name":"c","type":"FunctionArgument"}}}},"STACK":{"block":{"type":"blockComment","id":"6Uw]Be%4tt8@04I(?os]","fields":{"FIELDNAME":"This function checks if 3 given positions are full, with the same color.\nWe can use this function to check the board, row by row. For example,\ncheck_three(3, 4, 5) will check that the middle row is complete."},"next":{"block":{"type":"blockComment","id":"5%P-kD=;.nHRkt83^8DM","fields":{"FIELDNAME":"If any position is empty, then this row/column/diagonal is not complete.\nSo we return false."},"next":{"block":{"type":"blockIfElse","id":"GuCiCHXPA2u!Rm~(JZu:","extraState":{"optionLevel":0},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"U!S)vPg3$!NIQUXb3M.j"},"block":{"type":"blockLogicOperation","id":"72{]dydNF/r2LcO[jJrO","fields":{"OP":"OR"},"inputs":{"A":{"shadow":{"type":"blockLogicTrue","id":"/j6lnGjQ^._p0Lclg|C("},"block":{"type":"blockFunctionCallerValue","id":"W597#G!.uCIFEzMEq0hl","extraState":{"optionLevel":1},"fields":{"ICON":"TASK","VAR":{"id":"`i+))ZMLOarY}fnWKlvS"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"F_x%bg+paPBS}iT?)eye","fields":{"NUM":0}},"block":{"type":"variables_setup_function_argumentConstant","id":"]WDl;3P)~xkd_O[0JZLf","fields":{"VAR":{"text":"a"}}}}}}},"B":{"shadow":{"type":"blockLogicTrue","id":"M1~yR*]ez2|$SAtOQ_^}"},"block":{"type":"blockLogicOperation","id":"3LcNBlHlT#|0d|EQ|o-D","fields":{"OP":"OR"},"inputs":{"A":{"shadow":{"type":"blockLogicTrue","id":"XQ_@*el})KaE4K_w:nn0"},"block":{"type":"blockFunctionCallerValue","id":"aTQqF@jwVMD7Gie)y35`","extraState":{"optionLevel":1},"fields":{"ICON":"TASK","VAR":{"id":"`i+))ZMLOarY}fnWKlvS"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"g[8=J6xg2%hI8KQSG4oA","fields":{"NUM":0}},"block":{"type":"variables_setup_function_argumentConstant","id":"gA*`vi1vOGTw4ueg^KlB","fields":{"VAR":{"text":"b"}}}}}}},"B":{"shadow":{"type":"blockLogicTrue","id":"Vc4THT[u:_5Z,8C_2?nx"},"block":{"type":"blockFunctionCallerValue","id":"6b/7X^y2F+Fe!enArlgl","extraState":{"optionLevel":1},"fields":{"ICON":"TASK","VAR":{"id":"`i+))ZMLOarY}fnWKlvS"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"Ok)f7GAs@GVn``/!h.6,","fields":{"NUM":0}},"block":{"type":"variables_setup_function_argumentConstant","id":",r0Vs}SIIXvjO4A/_aBR","fields":{"VAR":{"text":"c"}}}}}}}}}}}}},"DO0":{"block":{"type":"blockTaskReturn","id":"T/98V(,j0(#yXD#z*{:t","inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"w_fb(Zpb*V+7aE=HWd3M","fields":{"NUM":0}},"block":{"type":"blockNone","id":"v`3Xem(/Oh*=3ZKdR7*:"}}}}}},"next":{"block":{"type":"blockComment","id":"Qpcm3[_^z1}]j)np`@cJ","fields":{"FIELDNAME":"If all pixels are the same, then the row/column/diagonal is complete!"},"next":{"block":{"type":"blockIfElse","id":"@]n*^iNptChldhnAKuen","extraState":{"optionLevel":0},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"qn@E,c](@JW_s(F$dVm6"},"block":{"type":"blockLogicOperation","id":"lhS2Gz/2y$tnB8Hg}Sv!","fields":{"OP":"AND"},"inputs":{"A":{"shadow":{"type":"blockLogicTrue","id":"/j6lnGjQ^._p0Lclg|C("},"block":{"type":"blockLogicCompare","id":"6UNGWXu-~}4;CgU|IVac","fields":{"OP1":"EQ"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"3zr;vKpo}$;rNUtpTQPz","fields":{"NUM":3}},"block":{"type":"blockFunctionCallerValue","id":"m!@70n%FV5!$Ix~n)*O%","extraState":{"optionLevel":1},"fields":{"ICON":"TASK","VAR":{"id":",ix$7lYFLANh,-P4K|W3"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"eEO[?V]RQ07L!^S@5.sN","fields":{"NUM":0}},"block":{"type":"variables_setup_function_argumentConstant","id":"L,S|0MM6fue(yBN`ltan","fields":{"VAR":{"text":"a"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"VB*?yU!X{;KH:2WV6H:f","fields":{"NUM":4}},"block":{"type":"blockFunctionCallerValue","id":"ozL]zv!i`L(3^HzEY1`5","extraState":{"optionLevel":1},"fields":{"ICON":"TASK","VAR":{"id":",ix$7lYFLANh,-P4K|W3"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"GR|XuHDL`xr9`TDc$/f1","fields":{"NUM":0}},"block":{"type":"variables_setup_function_argumentConstant","id":"S2]rddTnZ9wL#*9ouTFE","fields":{"VAR":{"text":"b"}}}}}}}}}},"B":{"shadow":{"type":"blockLogicTrue","id":"M1~yR*]ez2|$SAtOQ_^}"},"block":{"type":"blockLogicCompare","id":"3nMH7Dk8*.C%.u!G1Y_4","fields":{"OP1":"EQ"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"Tx{eRcknA(s_:XH[yE(#","fields":{"NUM":3}},"block":{"type":"blockFunctionCallerValue","id":"yb]+#$Lb.vJrB!htSi69","extraState":{"optionLevel":1},"fields":{"ICON":"TASK","VAR":{"id":",ix$7lYFLANh,-P4K|W3"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"]VUdz6cvj-*fyH5x8qwK","fields":{"NUM":0}},"block":{"type":"variables_setup_function_argumentConstant","id":"B`J=:ndB1w9d`3Eu~mFS","fields":{"VAR":{"text":"a"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"^M0V|J2XzUA/J#+vK+W%","fields":{"NUM":4}},"block":{"type":"blockFunctionCallerValue","id":"qC$SL#5lWSm@u]Z=azi|","extraState":{"optionLevel":1},"fields":{"ICON":"TASK","VAR":{"id":",ix$7lYFLANh,-P4K|W3"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"~=S=]tAMnO=j*,?+7%L{","fields":{"NUM":0}},"block":{"type":"variables_setup_function_argumentConstant","id":"=J@%hC)i;|0cWaRi/s$d","fields":{"VAR":{"text":"c"}}}}}}}}}}}}},"DO0":{"block":{"type":"blockComment","id":"`5ip3BC6{MMp!d?17pNr","fields":{"FIELDNAME":"We have a winnner! Let's celebrate by blinking the winning row\nin orange. To do that, we first have to make a copy of the board\nand set the winning row to orange."},"next":{"block":{"type":"blockFlowForEach","id":"xk-[oC5Q:0~KSM(?]0,r","inputs":{"VAR":{"shadow":{"type":"variables_setup_iterable","id":"MR-;_hh=;X?F}]Owc(f(","fields":{"VAR":{"id":"jeoLf1U7V_9TojbL]Cjj","name":"item","type":"LoopVariable"}}}},"LIST":{"shadow":{"type":"blockListEmpty","id":"f;[Cg!k)j=MNV*8{[-Wb"},"block":{"type":"blockRange","id":"i8dD633YZ/0GOzd77EBe","extraState":{"optionLevel":0},"inputs":{"RANGE_TO":{"shadow":{"type":"blockMathNumber","id":"rm6e`wuLgt_%d[l*{bL3","fields":{"NUM":9}}}}}},"DO":{"block":{"type":"blockComment","id":"qO)DSpS?}vT?J~|M*G8L","fields":{"FIELDNAME":"So loop over all 9 positions. If it matches one of the winning\npositions, then make it orange. Otherwise keep it the existing\ncolor for that position."},"next":{"block":{"type":"blockIfElse","id":"edoD^CPcaR$4^zW%UsnN","extraState":{"optionLevel":1},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"y~iUldJ/1M1iz(rvPZe("},"block":{"type":"blockIsIn","id":"akJeU.PA`$V=y|uVbMC]","inputs":{"VALUE0":{"shadow":{"type":"text","id":",L4ej43*UOUH!A~Ra#{e","fields":{"TEXT":"a"}},"block":{"type":"variables_setup_iterableConstant","id":"pPQ6c]S|HFi],$TVOk#4","fields":{"VAR":{"text":"item"}}}},"VALUE1":{"shadow":{"type":"text","id":"wmY`gZ_uf5jOMJG]%O@^","fields":{"TEXT":"abc"}},"block":{"type":"blockListCreate","id":"b0]SvB`S_:78LH#qQg-z","extraState":{"optionLevel":3},"inputs":{"ADD0":{"shadow":{"type":"blockMathNumber","id":".H=?;58Zg%=Sq7yn@H#*","fields":{"NUM":0}},"block":{"type":"variables_setup_function_argumentConstant","id":"3!~hx0b]!rF9i}LGCBPE","fields":{"VAR":{"text":"a"}}}},"ADD1":{"shadow":{"type":"blockMathNumber","id":"*|eWMuN?4g~w9m|*XKrp","fields":{"NUM":0}},"block":{"type":"variables_setup_function_argumentConstant","id":"Fwt1y.sc9.W~9Ry.Mh0q","fields":{"VAR":{"text":"b"}}}},"ADD2":{"shadow":{"type":"blockMathNumber","id":"U%!fy(/Nhp2!Zq}hb8)2","fields":{"NUM":0}},"block":{"type":"variables_setup_function_argumentConstant","id":"zg64:KuiFIBPJFTY|_P=","fields":{"VAR":{"text":"c"}}}}}}}}}},"DO0":{"block":{"type":"blockListSet","id":"LIMbEU?9rQmxuCrRem!g","extraState":{"optionLevel":1},"fields":{"METHOD":"LIST_SET_INDEX"},"inputs":{"LIST":{"shadow":{"type":"blockListEmpty","id":"h;D`Oy8pzC!UIew_e_Aj"},"block":{"type":"blockVariableGetValue","id":"n!;:jvvU$M3Z1T*5HNa1","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"#sVSyUWZ_nhvy4Y1,piR","fields":{"VAR":{"id":"9V2]u*M%BevJnMsZg+Uh","name":"game win","type":"Any"}}}}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"sH%}AG4fJysF9fVxreBR","fields":{"NUM":0}},"block":{"type":"variables_setup_iterableConstant","id":"T*1O#BEpL048o/{/WOa`","fields":{"VAR":{"text":"item"}}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"8zjYjYx)f.Qbw++EkUB$","fields":{"NUM":123}},"block":{"type":"variables_get_color","id":"E-Pa1+{xh.q=KuYS4!CZ","fields":{"COLOUR":"#ff8000","VAR":{"id":"LprohyP_eiZvg*HNgO_7"}}}}}}},"ELSE":{"block":{"type":"blockListSet","id":"B^9y,4}3Xx/GF=jmWhhJ","extraState":{"optionLevel":1},"fields":{"METHOD":"LIST_SET_INDEX"},"inputs":{"LIST":{"shadow":{"type":"blockListEmpty","id":"h;D`Oy8pzC!UIew_e_Aj"},"block":{"type":"blockVariableGetValue","id":"sX}AddJ)~5~-ehK0|:+j","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"9}O/=:_@3V96kDD^,gM:","fields":{"VAR":{"id":"9V2]u*M%BevJnMsZg+Uh","name":"game win","type":"Any"}}}}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"sH%}AG4fJysF9fVxreBR","fields":{"NUM":0}},"block":{"type":"variables_setup_iterableConstant","id":"SGI_-GM@G$=OIz?2zO[5","fields":{"VAR":{"text":"item"}}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"8zjYjYx)f.Qbw++EkUB$","fields":{"NUM":123}},"block":{"type":"blockFunctionCallerValue","id":"(Gae3o|)4r(8}:By_:F^","extraState":{"optionLevel":1},"fields":{"ICON":"TASK","VAR":{"id":",ix$7lYFLANh,-P4K|W3"}},"inputs":{"ARG0":{"shadow":{"type":"blockMathNumber","id":"}k$V4s1l~xb2Eq_wAzQ`","fields":{"NUM":0}},"block":{"type":"variables_setup_iterableConstant","id":"xOL|GLaX:^SZ}caGn^Rh","fields":{"VAR":{"text":"item"}}}}}}}}}}}}}}}},"next":{"block":{"type":"blockComment","id":":t[jg!C_=}2+y^YBcZ]K","fields":{"FIELDNAME":"Blink the winning game state 5 times."},"next":{"block":{"type":"blockFlowRepeat","id":"0R.,s62L3UTG[SR6s_ga","inputs":{"TIMES":{"shadow":{"type":"blockMathNumber","id":"#l:sa+P*0_%thA$z[#B@","fields":{"NUM":5}}},"DO":{"block":{"type":"blockLightOnColor","id":"gN]#.%lk$fK{#0cT-z9q","extraState":{"optionLevel":1},"fields":{"METHOD":"LIGHT_ON"},"inputs":{"VAR":{"shadow":{"type":"variables_get_color_light_device","id":"%($ZLDC}F=kVnu*_E3-z","fields":{"VAR":{"id":"f5#J(`}l~(!bOqrs5WKf","name":"matrix","type":"ColorLightMatrix"}}}},"COLOR":{"shadow":{"type":"variables_get_color","id":":%wC.hN59l;KK0Uzsh_J","fields":{"COLOUR":"#ff0000","VAR":{"id":"aTzv!_#C~rfTI(wu?8iR","name":"red","type":"ColorDef"}}},"block":{"type":"blockVariableGetValue","id":"0,Gfq6;AlZgAhyMChF]F","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"url4LSKe;0{|_{.T?gf)","fields":{"VAR":{"id":"9V2]u*M%BevJnMsZg+Uh","name":"game win","type":"Any"}}}}}}}},"next":{"block":{"type":"blockWaitTime","id":"80KsWa5yO+^R1b$49xc8","inputs":{"VALUE0":{"shadow":{"type":"unit_time","id":"?h#VR,cyP(cL)$kXn3os","fields":{"VALUE0":500}}}},"next":{"block":{"type":"blockLightOnColor","id":"r7#Tj#t:v[]yU2_-WddG","extraState":{"optionLevel":1},"fields":{"METHOD":"LIGHT_ON"},"inputs":{"VAR":{"shadow":{"type":"variables_get_color_light_device","id":"L@/~%iH(p0bpVM]tZtRX","fields":{"VAR":{"id":"f5#J(`}l~(!bOqrs5WKf","name":"matrix","type":"ColorLightMatrix"}}}},"COLOR":{"shadow":{"type":"variables_get_color","id":"@k|fOJnz:O=H8gNN2o43","fields":{"COLOUR":"#ff0000","VAR":{"id":"aTzv!_#C~rfTI(wu?8iR","name":"red","type":"ColorDef"}}},"block":{"type":"blockVariableGetValue","id":"f;yd~6mnLr:v*!.r)ult","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"n+Xr}-oz|T_qI35,Lu,?","fields":{"VAR":{"id":"0C)XDfi$7mcRSq[2oDu/","name":"game","type":"Any"}}}}}}}},"next":{"block":{"type":"blockWaitTime","id":"C%S]CRVD:R3}zknVPOjv","inputs":{"VALUE0":{"shadow":{"type":"unit_time","id":"3/6PS4YOGmW@:j=ciP#.","fields":{"VALUE0":500}}}}}}}}}}}}},"next":{"block":{"type":"blockComment","id":"fdA)+rv`=]%!:_e=55UJ","fields":{"FIELDNAME":"This completes the game, so we end the program."},"next":{"block":{"type":"blockLightOnColor","id":"h;D3LNr6AdXForAdofs`","extraState":{"optionLevel":1},"fields":{"METHOD":"LIGHT_ON"},"inputs":{"VAR":{"shadow":{"type":"variables_get_color_light_device","id":"gT*`;A+ivB,~(EA{a.e?","fields":{"VAR":{"id":"f5#J(`}l~(!bOqrs5WKf","name":"matrix","type":"ColorLightMatrix"}}}},"COLOR":{"shadow":{"type":"variables_get_color","id":"@k|fOJnz:O=H8gNN2o43","fields":{"COLOUR":"#000000","VAR":{"id":"@Yu4GIQai]=C7+4iG5*W","name":"none","type":"ColorDef"}}}}},"next":{"block":{"type":"blockProgramStop","id":"G9O2xQto98XzIJas5(Rc"}}}}}}}}}}}}}}}}}}}}}}}}}}},{"type":"variables_setup_function","id":"cI1D|ve~mRtZnRFUK-SL","x":658,"y":60,"extraState":{"optionLevel":1},"fields":{"ICON":"TASK","VAR":{"id":"`i+))ZMLOarY}fnWKlvS"}},"inputs":{"ARG0":{"shadow":{"type":"variables_setup_function_argument","id":"l92t|{^p48*,)$zLVfx(","fields":{"VAR":{"id":"~xL73TcV;ve@d.`S)k+O","name":"position","type":"FunctionArgument"}}}},"STACK":{"block":{"type":"blockComment","id":"9riC0Gev87VB4iy(a1U?","fields":{"FIELDNAME":"This function checks if the given position on the board\nis still free, by checking that the color is none.\nIt returns True if it's empty, and False if not.\n\nWe make a function for this, so we can easily check\nthis in several places in the program. That way we don't\nhave to repeat this code, and the word \"empty\" is easier\nto read than checking what all these lists blocks do."},"next":{"block":{"type":"blockTaskReturn","id":"0kUS.tzwv1=uQMNwLC7L","inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"fiM6u@cme]Uvs@eAj8+x","fields":{"NUM":0}},"block":{"type":"blockLogicCompare","id":":~^-v)uKViG7O;aBjUy{","fields":{"OP1":"EQ"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"[^a*$)iaz}5Y^OJu)SJi","fields":{"NUM":3}},"block":{"type":"blockListGet","id":"@;YaZMi6I-lV/CtM$H(7","extraState":{"optionLevel":1},"fields":{"METHOD":"LIST_GET_INDEX"},"inputs":{"LIST":{"shadow":{"type":"blockListEmpty","id":"We#g.K:*Qw8xGuUAQdE)"},"block":{"type":"blockVariableGetValue","id":"_Pn;yb,a()aFfEQ!g_6]","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"OY.Piz%=|g_4%*V5Ud.J","fields":{"VAR":{"id":"0C)XDfi$7mcRSq[2oDu/","name":"game","type":"Any"}}}}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"{UUN[5H2^r8)IdEKHmE1","fields":{"NUM":0}},"block":{"type":"variables_setup_function_argumentConstant","id":"0l/G:IyMO@K)*eaw1BJB","fields":{"VAR":{"text":"position"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"H4V=u6ZRCYN,_cc(m90O","fields":{"NUM":4}},"block":{"type":"variables_get_color","id":"`Pta+Ai@0a)v,n5DdVgk","fields":{"COLOUR":"#000000","VAR":{"id":"@Yu4GIQai]=C7+4iG5*W"}}}}}}}}}}}}}},{"type":"variables_setup_function","id":"s|o,ppIM2n!`^Xdzn_%9","x":657,"y":470,"extraState":{"optionLevel":1},"fields":{"ICON":"TASK","VAR":{"id":",ix$7lYFLANh,-P4K|W3"}},"inputs":{"ARG0":{"shadow":{"type":"variables_setup_function_argument","id":"iq_L`!Bwxmv5gMoFNA9G","fields":{"VAR":{"id":"~xL73TcV;ve@d.`S)k+O","name":"position","type":"FunctionArgument"}}}},"STACK":{"block":{"type":"blockComment","id":";2VD:mJ-HlSNCCNDnT_N","fields":{"FIELDNAME":"This function gets the color at the given position.\n\nWe make a function for this, so we can just use color(4) to\ncheck what the color at position 4 is, which makes the other\ncode easier to read."},"next":{"block":{"type":"blockTaskReturn","id":"6!zFNLD~93!+4GTQhzwf","inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"fiM6u@cme]Uvs@eAj8+x","fields":{"NUM":0}},"block":{"type":"blockListGet","id":"T]s]E?5bCkeGKrqr=m3Y","extraState":{"optionLevel":1},"fields":{"METHOD":"LIST_GET_INDEX"},"inputs":{"LIST":{"shadow":{"type":"blockListEmpty","id":"We#g.K:*Qw8xGuUAQdE)"},"block":{"type":"blockVariableGetValue","id":"_vAqA)7b4?z0CAk;!0dK","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"We{xfOSiM-K9ZVf48!$~","fields":{"VAR":{"id":"0C)XDfi$7mcRSq[2oDu/","name":"game","type":"Any"}}}}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"{UUN[5H2^r8)IdEKHmE1","fields":{"NUM":0}},"block":{"type":"variables_setup_function_argumentConstant","id":"]Y*p9dd^l]p}u!SgEN}D","fields":{"VAR":{"text":"position"}}}}}}}}}}}}}}]},"variables":[{"name":"red","id":"aTzv!_#C~rfTI(wu?8iR","type":"ColorDef"},{"name":"orange","id":"LprohyP_eiZvg*HNgO_7","type":"ColorDef"},{"name":"yellow","id":"o{*Ac.7Euy9qs7|;7fN(","type":"ColorDef"},{"name":"green","id":":ik{@hWAG/[aPDCqjL.l","type":"ColorDef"},{"name":"cyan","id":"3Kwg^xqs/UwE@aZgEDT/","type":"ColorDef"},{"name":"blue","id":"EWz^^l3.[aeA,HT79hZf","type":"ColorDef"},{"name":"violet","id":"AfSl,9{yp)16OE/p0T]%","type":"ColorDef"},{"name":"magenta","id":"jWP$-#sVis0+kKd|-YKn","type":"ColorDef"},{"name":"white","id":"aYIJoh-}4`.kH7:G/9T_","type":"ColorDef"},{"name":"none","id":"@Yu4GIQai]=C7+4iG5*W","type":"ColorDef"},{"name":"matrix","id":"f5#J(`}l~(!bOqrs5WKf","type":"ColorLightMatrix"},{"name":"hub","id":"az`,0d)vZ#19vr}|bF`9","type":"EssentialHub"},{"name":"player","id":"![[[NLyH_2[.NvpiISoB","type":"Motor"},{"name":"blink time","id":"=%(bav]WBxi5o,;0=9D|","type":"StopWatch"},{"name":"index","id":"emJj5[6$8~B412X_y;8f","type":"LoopVariable"},{"name":"item","id":"jeoLf1U7V_9TojbL]Cjj","type":"LoopVariable"},{"name":"blink color","id":"}4E6!r8(8EC~Md[[0y9T","type":"LoopVariable"},{"name":"current","id":"Xh2]1$w;@#-wD:h7sh{E","type":"FunctionArgument"},{"name":"a","id":"Pkr_3Z79v+e.S?R(EFj.","type":"FunctionArgument"},{"name":"b","id":"4$32u,DT$rbR1Kv1M:kK","type":"FunctionArgument"},{"name":"c","id":"1ou`44W7`q}U+b[S@2rk","type":"FunctionArgument"},{"name":"position","id":"~xL73TcV;ve@d.`S)k+O","type":"FunctionArgument"},{"name":"find next free spot","id":"]t`596M^YL~XEaP#]scT","type":"Function"},{"name":"turn is complete","id":"sLaAN?.R%%IfP[wNu-`?","type":"Function"},{"name":"check win","id":"JewIrE7WluNH!g@zFH:[","type":"Function"},{"name":"test one row","id":"=aT_znU4^@0XF=_AC~QZ","type":"Function"},{"name":"empty","id":"`i+))ZMLOarY}fnWKlvS","type":"Function"},{"name":"color","id":",ix$7lYFLANh,-P4K|W3","type":"Function"},{"name":"turn","id":"#qhABd_GG5Gz$@C*cw2X","type":"Any"},{"name":"game","id":"0C)XDfi$7mcRSq[2oDu/","type":"Any"},{"name":"location","id":"k[~x_ylf}6S7#T)b|o[W","type":"Any"},{"name":"game win","id":"9V2]u*M%BevJnMsZg+Uh","type":"Any"}],"info":{"type":"pybricks","version":"1.2.3"}}
from pybricks.hubs import EssentialHub
from pybricks.parameters import Button, Color, Direction, Port, Stop
from pybricks.pupdevices import ColorLightMatrix, Motor
from pybricks.tools import StopWatch, wait
from urandom import choice

# Set up all devices.
hub = EssentialHub()
matrix = ColorLightMatrix(Port.B)
blink_time = StopWatch()
player = Motor(Port.A, Direction.CLOCKWISE)

# Initialize variables.
turn = choice([Color.BLUE, Color.GREEN])
game = [Color.NONE] * 9
game_win = [Color.NONE] * 9
location = 8

def empty(position):
    # This function checks if the given position on the board
    # is still free, by checking that the color is none.
    # It returns True if it's empty, and False if not.

    # We make a function for this, so we can easily check
    # this in several places in the program. That way we don't
    # have to repeat this code, and the word "empty" is easier
    # to read than checking what all these lists blocks do.
    return game[position] == Color.NONE

def test_one_row(a, b, c):
    # This function checks if 3 given positions are full, with the same color.
    # We can use this function to check the board, row by row. For example,
    # check_three(3, 4, 5) will check that the middle row is complete.
    # If any position is empty, then this row/column/diagonal is not complete.
    # So we return false.
    if empty(a) or empty(b) or empty(c):
        return None
    # If all pixels are the same, then the row/column/diagonal is complete!
    if color(a) == color(b) and color(a) == color(c):
        # We have a winnner! Let's celebrate by blinking the winning row
        # in orange. To do that, we first have to make a copy of the board
        # and set the winning row to orange.
        for item in range(9):
            # So loop over all 9 positions. If it matches one of the winning
            # positions, then make it orange. Otherwise keep it the existing
            # color for that position.
            if item in [a, b, c]:
                game_win[item] = Color.ORANGE
            else:
                game_win[item] = color(item)
        # Blink the winning game state 5 times.
        for count in range(5):
            matrix.on(game_win)
            wait(500)
            matrix.on(game)
            wait(500)
        # This completes the game, so we end the program.
        matrix.on(Color.NONE)
        raise SystemExit

def color(position):
    # This function gets the color at the given position.

    # We make a function for this, so we can just use color(4) to
    # check what the color at position 4 is, which makes the other
    # code easier to read.
    return game[position]

def find_next_free_spot(current):
    # To find the next free spot, go over all 9 spots, and
    # return the first one that is free, so no color. We
    # start checking from the given position
    for index in range(current, current + 9, 1):
        if color(index % 9) == Color.NONE:
            # If that spot still has no color, we can use it.
            return index % 9
    # If we didn't find a free spot anywhere, all spots are full. And yet
    # nobody has one yet. so it's a draw. Game over!
    # Blink a white flag to indicate this.
    matrix.on(Color.WHITE)
    wait(1000)
    matrix.on(Color.NONE)
    raise SystemExit

def check_win():
    # Check rows for a winner.
    test_one_row(0, 1, 2)
    test_one_row(3, 4, 5)
    test_one_row(6, 7, 8)
    # Check columns for a winner.
    test_one_row(0, 3, 6)
    test_one_row(1, 4, 7)
    test_one_row(2, 5, 8)
    # Check diagonals for a winner.
    test_one_row(0, 4, 8)
    test_one_row(2, 4, 6)

def turn_is_complete():
    # Blue's turn is complete if they push the motor to the positive side.
    if turn == Color.BLUE and player.angle() > 30:
        return True
    # Green's turn is complete if they push the motor to the negative side.
    if turn == Color.GREEN and player.angle() < -30:
        return True
    # Otherwise the turn is not done, so return false.
    return False


# The main program starts here.
# The tic tac toe game can be described at any time by:
# - the state of the board (which spots are full, with either blue or green)
# - whose turn it currently is (green or blue)

# To make things simple, we represent the game state with a list of 9 colors.
# That way, we can directly show the current state on the color light matrix.
# The color "none" is used to indicate a free spot.

# In the setup, we randomly assign the first turn to either the green or blue
# player. For each completed turn, we add the current player's color to their
# selected position on the board (the selected position in the list).
# Allow the button to be used as an input, instead of stopping the program.
hub.system.set_stop_button(None)
hub.light.on(Color.NONE)
# Let the motor randomly indicate the first player.
if turn == Color.GREEN:
    player.run_target(500, 765, Stop.COAST)
else:
    player.run_target(500, 675, Stop.COAST)
# Discard the two full turns and reset the rotation sensor back to the
# marker on the shaft. This way, positive angles indicate the green
# player and negative angles indicate the blue player.
player.reset_angle(None)
# This is the outer loop. It repeats full turns until the game completes.
while True:
    hub.light.on(turn)
    # This loop executes one turn of the current player, so it runs until
    # the current turn is complete. We check that in a separate function.
    while not turn_is_complete():
        # The turn starts by ensuring the previous press is now released,
        # so we don't immediately register another button press.
        while Button.CENTER in hub.buttons.pressed():
            wait(1)
        # Find the next free spot, up one from the last location.
        location = find_next_free_spot(location + 1)
        # Blink until turn or complete or button pressed. Instead of waiting
        # some time between turning the light on and off, we keep waiting
        # for several things at once. The blink is completes if it is time to
        # blink again or the turn is complete or the button is pressed to
        # change the selected position.
        while not (turn_is_complete() or Button.CENTER in hub.buttons.pressed()):
            # Show game state for the current selection being off and then on.
            # This creates a blink.
            for blink_color in [turn, Color.NONE]:
                game[location] = blink_color
                matrix.on(game)
                blink_time.reset()
                while not (blink_time.time() > 200 or turn_is_complete() or Button.CENTER in hub.buttons.pressed()):
                    wait(1)
        # The blink might just have been on or off at this point, so reinstate
        # game state based on whether turn complete or not.
        game[location] = turn if turn_is_complete() else Color.NONE
    # With the user turn complete, we can check if anyone has one yet,
    # using a separate function. That will then exit the program.
    check_win()
    # But otherwise it is the next player's turn. So change to blue if it was
    # green, or change to green if it was blue.
    turn = Color.BLUE if turn == Color.GREEN else Color.GREEN
